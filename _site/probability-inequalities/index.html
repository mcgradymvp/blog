<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Probablity Inequalities - Fan’s Personal Blog</title>







<meta property="og:locale" content="en-GB">
<meta property="og:site_name" content="Fan's Personal Blog">
<meta property="og:title" content="Probablity Inequalities">


  <link rel="canonical" href="http://localhost:4000/probability-inequalities/">
  <meta property="og:url" content="http://localhost:4000/probability-inequalities/">



  <meta property="og:description" content="Probability InequalitiesMarkov’s InequalityLet $X$ be a non-negative random variable. For any $t&gt;0$, $P(X&gt;t)\leq \frac{E(X)}{t}$.">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-11-18T00:00:00+08:00">
  
  





  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "person",
      "name" : "Fan Wang",
      "url" : "http://localhost:4000",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->

<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Fan's Personal Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<link rel="apple-touch-icon" sizes="57x57" href="http://localhost:4000/images/icons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="http://localhost:4000/images/icons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/images/icons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="http://localhost:4000/images/icons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/images/icons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="http://localhost:4000/images/icons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/images/icons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="http://localhost:4000/images/icons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4000/images/icons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="http://localhost:4000/images/icons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="http://localhost:4000/images/icons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="http://localhost:4000/images/icons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="http://localhost:4000/images/icons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="http://localhost:4000/images/icons/manifest.json">
<link rel="mask-icon" href="http://localhost:4000/images/icons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="http://localhost:4000/images/icons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-TileImage" content="http://localhost:4000/images/icons/mstile-144x144.png">
<meta name="msapplication-config" content="http://localhost:4000/images/icons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->

    
  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://localhost:4000/">Fan's Personal Blog</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    



<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    <a href="http://localhost:4000/">
    
    	<img src="http://localhost:4000/images//avatar.jpg" class="author__avatar" alt="Fan Wang">
    
    </a>
  </div>

  <div class="author__content">
    <h3 class="author__name">Fan Wang</h3>
    <p class="author__bio">Bayesian</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li>
<i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> Singapore</li>
      
      
        <li><a href="http://wilfred.im"><i class="fa fa-fw fa-chain" aria-hidden="true"></i> Website</a></li>
      
      
      
      
      
      
      
        <li><a href="http://linkedin.com/in/:fan-wang-15022411b"><i class="fa fa-fw fa-linkedin-square" aria-hidden="true"></i> LinkedIn</a></li>
      
      
      
      
      
      
        <li><a href="http://github.com/mcgradymvp"><i class="fa fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Probablity Inequalities">
    <meta itemprop="description" content="Probability InequalitiesMarkov’s InequalityLet $X$ be a non-negative random variable. For any $t&gt;0$, $P(X&gt;t)\leq \frac{E(X)}{t}$.">
    <meta itemprop="datePublished" content="November 18, 2017">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Probablity Inequalities
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  4 minutes read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <h1 id="probability-inequalities">Probability Inequalities</h1>
<h4 id="markovs-inequality">Markov’s Inequality</h4>
<p>Let $X$ be a non-negative random variable. For any $t&gt;0$, $P(X&gt;t)\leq \frac{E(X)}{t}$.</p>

<p>$Proof$. Since $X&gt;0$,
<script type="math/tex">% <![CDATA[
\begin{align}
    E(X) &=\int_0^{\infty} xp(x)dx=\int_0^t xp(x)dx+\int_t^{\infty} xp(x)dx\\
    & \geq \int_t^{\infty} xp(x)dx \geq t\int_t^{\infty} p(x)dx=tP(X>t).
  \end{align} %]]></script></p>

<h4 id="chebyshevs-inequality">Chebyshev’s Inequality</h4>
<p>Let $\mu = E(X)$ and $\sigma^2=Var(X)$. Then,
<script type="math/tex">P(|X-\mu|\geq t)\leq \frac{\sigma^2}{t^2}.</script>
$Proof$. By $Markov’s$ $Inequality$,
<script type="math/tex">P(|X-\mu|\geq t)=P(|X-\mu|^2 \geq t^2) \leq \frac{E[(X-\mu)^2]}{t^2}=\frac{\sigma^2}{t^2}.</script></p>

<h4 id="hoeffdings-inequality">Hoeffding’s Inequality</h4>
<p>Let $Y_1, Y_2,\ldots, Y_n$ be independent random variables. $E(Y_i)=0$ and $a_i\leq Y_i \leq b_i$.
Let $\varepsilon&gt;0$, then for any $t&gt;0$,
<script type="math/tex">P(\sum_{i=1}^n Y_i \geq \varepsilon) \leq e^{-t\varepsilon}\prod_{i=1}^n e^{t^2(b_i-a_i)^2/8}</script>
$Proof$. Consider that
<script type="math/tex">% <![CDATA[
\begin{align}
    P(\sum_{i=1}^n Y_i & \geq \varepsilon)=P(t\sum_{i=1}^n Y_i \geq t\varepsilon)\\
    & =P(e^{t\sum_{i=1}^n Y_i}\geq e^{t\varepsilon})\\
    & \leq e^{-t\varepsilon}E(e^{t\sum_{i=1}^n Y_i})\\
    & =e^{-t\varepsilon}\prod_{i=1}^nE(e^{tY_i})
  \end{align} %]]></script>
Since $a_i\leq Y_i \leq b_i$, we can write $Y_i$ as $Y_i=\alpha b_i +(1-\alpha)a_i$ for some $\alpha\in[0,1]$.
So $\alpha = \frac{Y_i-a_i}{b_i-a_i}$.
We also noticed that $e^{ty}$ is a convex function, therefore,
<script type="math/tex">e^{tY_i}\leq\frac{Y_i-a_i}{b_i-a_i}e^{tb_i}+\frac{b_i-Y_i}{b_i-a_i}e^{ta_i}\\
\Rightarrow \qquad E(e^{tY_i})\leq -\frac{a_i}{b_i-a_i}e^{tb_i}+\frac{b_i}{b_i-a_i}e^{ta_i}</script>
If we take
<script type="math/tex">% <![CDATA[
\begin{align}
& u=t(b_i-a_i)\\
& g(u)=-\gamma u+\log(1-\gamma+\gamma e^u)\\
& \gamma=-\frac{a_i}{b_i-a_i}
\end{align} %]]></script>
Then we have
<script type="math/tex">E(e^{tY_i})\leq e^{g(u)}</script>
By Taylor’s Theorem,
<script type="math/tex">g(u)\leq g(0)+ug'(0)+\frac{u^2}{2}g''(0)\leq \frac{u^2}{8}=\frac{t^2(b_i-a_i)^2}{8}</script>
So
<script type="math/tex">E(e^{tY_i})\leq e^{t^2(b_i-a_i)^2/8}\\
  \Rightarrow\qquad P(\sum_{i=1}^n Y_i \geq \varepsilon) \leq e^{-t\varepsilon}\prod_{i=1}^n e^{t^2(b_i-a_i)^2/8}</script></p>

<h4 id="mills-inequality">Mill’s Inequality</h4>
<p>let $Z\sim N(0,1)$. Then,
<script type="math/tex">P(|Z|>t)\leq \sqrt{\frac{2}{\pi}}e^{-\frac{t^2}{2}}/t</script>
$Proof$.
<script type="math/tex">% <![CDATA[
\begin{align}
  P(|Z|>t)=2P(Z>t) & =\frac{1}{\sqrt{2\pi}}\int_t^{infty} e^{-\frac{1}{2}x^2}dx\\
  &\leq\frac{1}{\sqrt{2\pi}}\int_t^{infty}\frac{x}{t}e^{-\frac{1}{2}x^2}dx\\
  &=\frac{1}{t\sqrt{2\pi}}\Big(-e^{-\frac{1}{2}x^2}|_t^{\infty}\Big)\\
  &=\frac{1}{t\sqrt{2\pi}}e^{-\frac{1}{2}t^2}
\end{align} %]]></script>
Therefore,
<script type="math/tex">P(|Z|>t)\leq \sqrt{\frac{2}{\pi}}e^{-\frac{t^2}{2}}/t.</script></p>

<h4 id="cauchy-schwartz-inequality">Cauchy-Schwartz Inequality</h4>
<p>If $X$ and $Y$ have finite variances, then
<script type="math/tex">E(XY)\leq\sqrt{E(X^2)E(Y^2)}</script>
$Proof$. Let’s consider $E[(X-\alpha Y)^2]$.
<script type="math/tex">0\leq E[(X-\alpha Y)^2]=E(X^2)+\alpha^2 E(Y^2)-2\alpha E(XY)</script>
If we take $\alpha=\frac{E(XY)}{E(Y^2)}$
<script type="math/tex">0\leq E(X^2)-\frac{[E(XY)]^2}{E(Y^2)}</script>
which is
<script type="math/tex">E(XY)\leq\sqrt{E(X^2)E(Y^2)}.</script></p>

<h4 id="jensens-inequality">Jensen’s Inequality</h4>
<p>If $g(x)$ is convex, then $E(g(X))\geq g(E)$. If $g(x)$ is concave, then $E(g(X))\leq g(E)$.</p>

<p>$Proof$.
Let’s take $L=a+bX$ as a tangent line to $g(x)$ at $E(X)$.</p>

<p>Since $g(x)$ is convex,
<script type="math/tex">E(g(X))\geq E(a+bX)=a+bE(X)=g(E(X)).</script></p>

<p>We are now ready to split the test and training sets back into their original states, carrying our fancy new engineered variables with them. The nicest part of what we just did is how the factors are treated in R. Behind the scenes, factors are basically stored as integers, but masked with their text names for us to look at. If you create the above factors on the isolated test and train sets separately, there is no guarantee that both groups exist in both sets.</p>

<p>For instance, the family “3Johnson” previously discussed does not exist in the test set. We know that all three of them survive from the training set data. If we had built our factors in isolation, there would be no factor “3Johnson” for the test set. This would upset any machine learning model because the factors between the training set used to build the model and the test set it is asked to predict for are not consistent. ie. R will throw errors at you if you try.</p>

<p>Because we built the factors on a single dataframe, and then split it apart after we built them, R will give all factor levels to both new dataframes, even if the factor doesn’t exist in one. It will still have the factor level, but no actual observations of it in the set. Neat trick right? Let me assure you that manually updating factor levels is a pain.</p>

<p>So let’s break them apart and do some predictions on our new fancy engineered variables:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">combi</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">891</span><span class="p">,]</span><span class="w">
</span><span class="o">&gt;</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">combi</span><span class="p">[</span><span class="m">892</span><span class="o">:</span><span class="m">1309</span><span class="p">,]</span><span class="w">
</span></code></pre></div></div>

<p>Here we introduce yet another subsetting method in R; there are many depending on how you want to chop up your data. We have isolated certain ranges of rows of the combi dataset based on the sizes of the original train and test sets. The comma after that with no numbers following it indicates that we want to take ALL columns with this subset and store it to the assigned dataframe. This gives us back our original number of rows, as well as all our new variables including the consistent factor levels.</p>

<p>Time to do our predictions! We have a bunch of new variables, so let’s send them to a new decision tree. Last time the default complexity worked out pretty well, so let’s just grow a tree with the vanilla controls and see what it can do:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span><span class="w"> </span><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rpart</span><span class="p">(</span><span class="n">Survived</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Pclass</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Sex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Age</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">SibSp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Parch</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Fare</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Embarked</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Title</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FamilySize</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">FamilyID</span><span class="p">,</span><span class="w">
</span><span class="n">data</span><span class="o">=</span><span class="n">train</span><span class="p">,</span><span class="w">
</span><span class="n">method</span><span class="o">=</span><span class="s2">"class"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="http://localhost:4000/images/2014-01-16-r-part-4-feature-engineering-2.png" alt="Engineered tree" class="align-center"></p>

<p>Interestingly our new variables are basically governing our tree. Here’s another drawback with decision trees that I didn’t mention last time: they are biased to favour factors with many levels. Look at how our 61-level FamilyID factor is so prominent here, and the tree picked out all the families that are biased one way more than the others. This way the decision node can chop and change the data into the best way possible combination for purity of the following nodes.</p>

<p>But all that aside, you know should know how to create a submission from a decision tree, so let’s see how it performed!</p>

<p><img src="http://localhost:4000/images/2014-01-16-r-part-4-feature-engineering-3.png" alt="Submission 6" class="align-center"></p>

<p>Awesome, we just almost halved our rank! All by squeezing a bit more value out of what we already had. And this is just a sample of what you might be able to find in this dataset.</p>

<p>Go ahead and try and create some more engineered variables! As before, I also really encourage you to play around with the complexity parameters and maybe try trimming some deeper trees to see if it helps or hinders your rank. You may even consider excluding some variables from the tree to see if that changes anything too.</p>

<p>In most cases though, the title or gender variables will govern the first decision due to the greedy nature of decision trees. The bias towards many-levelled factors won’t go away either, and the overfitting problem can be difficult to gauge without actually sending in submissions, but good judgement can help.</p>

<p>Next lesson, we will overcome these limitations by building an ensemble of decision trees with the powerful Random Forest algorithm. <a href="http://localhost:4000/kaggle-titanic-tutorial/r-part-5-random-forests" target="_blank">Go there now!</a></p>

<p>All code from this tutorial is available on my <a href="https://github.com/trevorstephens/titanic" target="_blank">Github repository</a></p>


        
      </section>

      <footer class="page__meta">
        
        


  




  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4000/tags/#competitions" class="page__taxonomy-item" rel="tag">Competitions</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4000/tags/#tutorial" class="page__taxonomy-item" rel="tag">Tutorial</a>
    
    </span>
  </p>






        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-11-18T00:00:00+08:00">November 18, 2017</time></p>
        
      </footer>

      

      


    </div>

    
      

<div class="page__comments">
  <h4 class="page__comments-title">Leave a Comment</h4>
  
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  
    <a href="http://localhost:4000/probability-inequalities/">
  
    <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
      
      <h2 class="archive__item-title" itemprop="headline">Probablity Inequalities
</h2>
      
        <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  4 minutes read
</p>
      
      
      <p class="archive__item-excerpt" itemprop="description">Probability Inequalities
Markov’s Inequality
Let $X$ be a non-negative random variable. For any $t&gt;0$, $P(X&gt;t)\leq \frac{E(X)}{t}$.

</p>
    </article>
  </a>
</div>

        
      </div>
    </div>
  
</div>


    <div class="page__footer">
      <footer>
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="http://github.com/mcgradymvp"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2017 Fan Wang. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="http://localhost:4000/assets/js/main.min.js"></script>





  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'mcgradymvp';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>






    <!-- start custom footer snippets -->

<!-- end custom footer snippets -->

  </body>
</html>
